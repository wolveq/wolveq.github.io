(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{292:function(a,t,s){"use strict";s.r(t);var n=s(16),r=Object(n.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"unity调用android方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unity调用android方法","aria-hidden":"true"}},[a._v("#")]),a._v(" Unity调用Android方法")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("首先将build.gardle中将application改为Library\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcn6lh98nj30v006qgm5.jpg",alt:""}})])]),a._v(" "),s("li",[s("p",[a._v("去掉build.gradle中android{}下的defaultConfig下的applicationId。\n"),s("img",{attrs:{src:"https://ws4.sinaimg.cn/large/006tNbRwly1fwcn7jmc0xj30r60haac9.jpg",alt:""}})])]),a._v(" "),s("li",[s("p",[a._v("找到unity的classes.jar包。windows下和mac下包的路径分别为\nC:\\ProgramFiles\\Unity\\Editor\\Data\\PlaybackEngines\\AndroidPlayer\\Variations\\mono\\Release\\classes.jar\n/Applications/Unity/PlaybackEngines/AndroidPlayer/Variations/mono/Release/Classes\\classes.jar")])]),a._v(" "),s("li",[s("p",[a._v("新建MainActivity并继承UnityPlayerActivity。")])]),a._v(" "),s("li",[s("p",[a._v("配置AndroidManifest.xml文件，将Android默认主题去掉，删掉values中style.xml文件，使用系统自带的主题文件。然后并配置ManActivity如下。\n"),s("img",{attrs:{src:"https://ws4.sinaimg.cn/large/006tNbRwly1fwcnalqpl3j31fa0o6dld.jpg",alt:""}})])]),a._v(" "),s("li",[s("p",[a._v("在MainActivity中编写unity调用的方法。\n"),s("img",{attrs:{src:"https://ws2.sinaimg.cn/large/006tNbRwly1fwcnb3baujj319m0xk0zo.jpg",alt:""}})])]),a._v(" "),s("li",[s("p",[a._v("生成aar包即可。")])]),a._v(" "),s("li",[s("p",[a._v("在unity中assets目录中，创建Plugins->Android目录，将aar和AndroidManifest.xml放进去。\n"),s("img",{attrs:{src:"https://ws4.sinaimg.cn/large/006tNbRwly1fwcndah2o7j30s60dw0up.jpg",alt:""}})])]),a._v(" "),s("li",[s("p",[a._v("在Scripts中创建c#文件。然后，一般调用Android方法如下：")])])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaClass")]),a._v(" jc "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.unity3d.player.UnityPlayer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaObject")]),a._v(" jo "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" jc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GetStatic")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"currentActivity"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\njo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Call")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"showToast"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"allow....code:"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("code"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('",msg:"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n\n")])])]),s("p",[a._v("至于c#调用android可以谷歌自行查看。")]),a._v(" "),s("ol",{attrs:{start:"10"}},[s("li",[a._v("在这里使用回调的方式，java中定义一个ResultCallback接口，然后c#也要写一个对应的接口。\n"),s("img",{attrs:{src:"https://ws4.sinaimg.cn/large/006tNbRwly1fwcnfp8k0sj30vk0dmmyy.jpg",alt:""}}),a._v(" "),s("img",{attrs:{src:"https://ws2.sinaimg.cn/large/006tNbRwly1fwcne7b8tbj31340myjxl.jpg",alt:""}}),a._v("\n然后传到android调用的方法参数中即可。\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcngh2ecej30yk06q40f.jpg",alt:""}}),a._v("\n其中")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaClass")]),a._v(" jc "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.unity3d.player.UnityPlayer"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaObject")]),a._v(" jo "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" jc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GetStatic")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AndroidJavaObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"currentActivity"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n\n")])])]),s("p",[a._v("是固定代码。\njo.call()函数第一个参数是Android调用的方法名，方法必须定义为public，参数为回调函数，Android中对应的java接口回调即可实现。")]),a._v(" "),s("ol",{attrs:{start:"11"}},[s("li",[a._v("unity打包事项在File中点击Build Setting。\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcnn0hx92j30k80jqn0d.jpg",alt:""}})]),a._v(" "),s("li",[a._v("选择Android，中点击Player Settings。\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcnnxnxdxj30j00w0gp5.jpg",alt:""}})]),a._v(" "),s("li",[a._v("在Other Settings中配置包名，版本号等，最小的API与TargetAPI要与Android中build.gradle中对应。\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcnonw8whj30jk08uab0.jpg",alt:""}})]),a._v(" "),s("li",[a._v("在Publishing Settings中配置一下打包签名。\n"),s("img",{attrs:{src:"https://ws3.sinaimg.cn/large/006tNbRwly1fwcnpho247j30jy0agjs9.jpg",alt:""}})]),a._v(" "),s("li",[a._v("配置成功后点击Build And Run即可生成apk并运行在Android设备上。\n"),s("img",{attrs:{src:"https://ws1.sinaimg.cn/large/006tNbRwly1fwcnqabxaxj30p00q6n08.jpg",alt:""}})])])])},[],!1,null,null,null);t.default=r.exports}}]);